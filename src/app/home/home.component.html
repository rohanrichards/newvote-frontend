<div *ngIf="auth.isVerified() && !auth.tourComplete()" class="tour-container" fxLayout="row" fxLayoutAlign="space-around center" >
	<h4 joyrideStep="step1"
	class="mat-subtitle-1">New to NewVote? Let us help you get started.</h4>
	<div>
		<button
			(click)="onDone($event)"
			stepPosition="right"
			mat-flat-button>
			Dismiss
		</button>
		<button
			(click)="startTour($event)"
			stepPosition="right"
			mat-flat-button color="warn">
			Start Tour
		</button>
	</div>

</div>

<joyrideStep
	[title]="stepsArray[0].title"
	joyrideStep="step1"
	stepPosition="center"
	[stepContent]="myCustomContent"
	(done)="onDone()"
	>
	<ng-template #myCustomContent>
		<div style="width: 300px">
			<h4 class="mat-subheading-2">{{stepsArray[0].description}}</h4>
		</div>
	</ng-template>
</joyrideStep>

<joyrideStep
	[title]="stepsArray[1].title"
	joyrideStep="step2"
	stepPosition="center"
	[stepContent]="myCustomContent2"
	(done)="onDone()"
	>
	<ng-template #myCustomContent2>
		<div style="width: 300px">
			<p class="mat-subheading-2">{{stepsArray[1].description}}</p>
		</div>
	</ng-template>
</joyrideStep>

<joyrideStep
	[title]="stepsArray[7].title"
	joyrideStep="finish"
	stepPosition="center"
	[stepContent]="myCustomContent3"
	(done)="onDone()"
	>
	<ng-template #myCustomContent3>
		<div style="width: 300px">
			<p class="mat-subheading-2">{{stepsArray[7].description}}</p>
		</div>
	</ng-template>
</joyrideStep>


<ng-container *ngIf="loadingState === 'complete'; then mainContainer; else skeletonHeader">
</ng-container>

<ng-template #skeletonHeader>
	<app-skeleton-header>
	</app-skeleton-header>
</ng-template>

<ng-template #mainContainer>
	<div
	fxLayout="column"
	 [@fadeIn]="!isLoading"
	 fxLayoutAlign="center center"
	 class="hero-image-container">
		<div *ngIf="org"
			class="hero-image"
			[defaultImage]="handleImageUrl(org.imageUrl, true)"
			[lazyLoad]="handleImageUrl(org.imageUrl)">
		</div>
		<div class="hero-logo-container"
			[defaultImage]="handleImageUrl(org.iconUrl, true)"
			[lazyLoad]="handleImageUrl(org.iconUrl)">
		</div>
	</div>
</ng-template>

<ng-container [ngSwitch]="loadingState">
	<div *ngSwitchCase="'loading'"
	 class="community-container container">
		<div fxLayout="column">
			<div class="skeleton-title-wrap">
				<app-skeleton-text-bar [isHeading]=true
				 [width]="200">
				</app-skeleton-text-bar>
				<app-skeleton-text-bar [isSubtitle]=true
				 [width]="150">
				</app-skeleton-text-bar>
			</div>
			<div class="skeleton-triple-divider-container">
				<div class="skeleton-triple-section">
					<app-skeleton-text-bar [isHeading]=true
					 [width]="25">
					</app-skeleton-text-bar>
					<app-skeleton-text-bar [isSubtitle]=true
					 [width]="50">
					</app-skeleton-text-bar>
				</div>
				<mat-divider vertical="true"></mat-divider>
				<div class="skeleton-triple-section">
					<app-skeleton-text-bar [isHeading]=true
					 [width]="25">
					</app-skeleton-text-bar>
					<app-skeleton-text-bar [isSubtitle]=true
					 [width]="50">
					</app-skeleton-text-bar>
				</div>
				<mat-divider vertical="true">
				</mat-divider>
				<div class="skeleton-triple-section">
					<app-skeleton-text-bar [isHeading]=true
					 [width]="25">
					</app-skeleton-text-bar>
					<app-skeleton-text-bar [isSubtitle]=true
					 [width]="50">
					</app-skeleton-text-bar>
				</div>
			</div>
			<app-skeleton-button [width]="100">
			</app-skeleton-button>
			<div class="skeleton-community-footer">
				<app-skeleton-text-bar [isText]=true>
				</app-skeleton-text-bar>
			</div>
			<div class="skeleton-community-cta">
				<app-skeleton-text-bar [isSubtitle]=true
				 width="40">
				</app-skeleton-text-bar>
			</div>
		</div>
	</div>
	<div *ngSwitchCase="'serverError'"
	 class="community-container container"
	 fxLayoutAlign="center center">
		<div fxFlex.gt-sm="690px"
		 fxFlex.gt-md="800px"
		 fxLayout="column">
			<div class="mat-display-1 no-margin">
				<span *ngIf="org">
					Server Eror
				</span>
			</div>
			<div class="mat-h2"
			 *ngIf="org">
				Could not load organization data.
			</div>
			<div>
				<span class="mat-caption">Try refreshing the page, otherwise contact NewVote</span>
			</div>
		</div>
	</div>
	<div

	*ngSwitchCase="'complete'"
	 [@fadeIn]=true
	 class="community-container container"
	 fxLayoutAlign="center center">
		<div
			fxFlex.gt-sm="690px"
		 fxFlex.gt-md="800px"
		 fxLayout="column">
			<div class="mat-display-1 no-margin">
				<span *ngIf="org">{{org.name}}</span>
			</div>
			<div class="mat-h2"
			 *ngIf="org">{{org.description}}</div>
			<div fxLayout="row">
				<div fxFlex></div>
				<div fxLayout="column">
					<span class="mat-h1"
					 *ngIf="userCount">{{ handleUserCount(userCount) }}</span>
					<span class="mat-h1"
					 *ngIf="!userCount">0</span>
					<span class="mat-h3">Members</span>
				</div>
				<div fxFlex></div>
				<mat-divider vertical="true"></mat-divider>
				<div fxFlex></div>
				<div fxLayout="column">
					<span class="mat-h1"
					 *ngIf="issues"><p  class="counter-click" routerLink="/issues">{{issues.length}}</p></span>
					<span class="mat-h1"
					 *ngIf="!issues">0</span>
					<span class="mat-h3">Issues</span>
				</div>
				<div fxFlex></div>
				<mat-divider vertical="true"></mat-divider>
				<div fxFlex></div>
				<div fxLayout="column">
					<span class="mat-h1"
					 *ngIf="proposals && solutions"><p class="counter-click" routerLink="/solutions">{{proposals.length + solutions.length}}</p></span>
					<span class="mat-h1"
					 *ngIf="!proposals || !solutions">0</span>
					<span class="mat-h3">Solutions</span>
				</div>
				<div fxFlex></div>
			</div>
			<div *ngIf="!auth.isAuthenticated()">
				<button *ngIf="!org || !org.authType || org.authType===0"
				 mat-button
				 mat-raised-button
				 routerLink="/auth/signup"
				 color="warn"
				 class="mat-display-1">
					CREATE ACCOUNT</button>
				<button *ngIf="org && org.authType===1"
				 mat-button
				 mat-raised-button
				 routerLink="/auth/login"
				 color="warn"
				 class="mat-display-1">
					CREATE ACCOUNT</button>
			</div>
			<div *ngIf="org">
				<div *ngIf="!org.owner">
					<span class="mat-caption">NewVote is not currently affiliated with {{org.name}}.</span>
					<span class="mat-caption">If you would like to claim leadership of the {{org.name}} community
						<button mat-button
						 [routerLink]="['/communities/claim/', org._id]"
						 color="primary"
						 class="mat-display-1">
							CLAIM HERE</button>
					</span>
				</div>
				<div *ngIf="org.owner">
					<span *ngIf="org.organizationName" class="mat-caption">{{org.organizationName }} is the leader of this community.</span>
				</div>
			</div>
		</div>
	</div>
</ng-container>

<div class="about-community-container container text-center container-white" fxLayoutAlign="center center"
	*ngIf="org && org.longDescription">
	<div fxFlex.gt-sm="690px" fxFlex.gt-md="800px">
		<span class='mat-body' [innerHtml]="org.longDescription"></span>
	</div>
</div>

<ng-container [ngSwitch]="loadingState">
	<div *ngSwitchCase="'loading'"
	 class="hot-issues-container container">
		<div class="skeleton-issues-container">
			<app-skeleton-text-bar class="skeleton-issue-header"
			 [isSubtitle]="true"
			 [width]="100">
			</app-skeleton-text-bar>
			<div class="skeleton-card-list">
				<app-skeleton-card>
				</app-skeleton-card>
				<app-skeleton-card>
				</app-skeleton-card>
				<app-skeleton-card>
				</app-skeleton-card>
			</div>
			<div class="skeleton-issues-footer">
				<app-skeleton-text-bar [isSubtitle]=true
				 [width]="75">
				</app-skeleton-text-bar>
			</div>
		</div>
	</div>

	<div *ngSwitchCase="'serverError'"
	 class="hot-issues-container container">
		<div class="skeleton-issues-container">
			<app-skeleton-text-bar class="skeleton-issue-header"
			 [isSubtitle]="true"
			 [width]="100">
			</app-skeleton-text-bar>
			<div class="skeleton-card-list">
				<app-skeleton-card>
				</app-skeleton-card>
				<app-skeleton-card>
				</app-skeleton-card>
				<app-skeleton-card>
				</app-skeleton-card>
			</div>
			<div class="skeleton-issues-footer">
				<app-skeleton-text-bar [isSubtitle]=true
				 [width]="75">
				</app-skeleton-text-bar>
			</div>
		</div>
	</div>

	<ng-template #customContent>	
		<div style="width: 300px">
			<p class="mat-subheading-2">{{stepsArray[2].description}}</p>
		</div>
	</ng-template>

	<div *ngSwitchCase="'complete'"
		joyrideStep="step3"
		[title]="stepsArray[2].title"
		[stepContent]="customContent"
		stepPosition="top"
		(done)="onDone()"
		[@fadeIn]=true
		class="hot-issues-container container text-center"
		fxLayoutAlign="center center">
		<div
			fxFlex.gt-sm="690px"
			fxFlex.gt-md="800px"
		 	>
			<h2 class="mat-h2">What's Hot?</h2>
			<ng-container 
			*ngIf="issues.length < 1; then noIssues; else issuesExist">
			</ng-container>
		</div>
	</div>

	<ng-template #noIssues>
		<h3 class="mat-h3">Currently there are no issues for this Organization</h3>
		<div *ngIf="auth.isOwner() || auth.isAdmin()">
			<p>Start engaging your community and create issues.</p>
			<button mat-button
			 color="primary"
			 routerLink="/issues/create">
				Create Issue
			</button>
		</div>
	</ng-template>
	<ng-template #issuesExist>
		<app-grid-list 
		*ngIf="issues"
		 path="/issues"
		 model="Issue"
		 [itemLimit]="ISSUE_LIMIT"
		 [titleCard]=true
		 [items]=issues
		 (delete)="onDelete($event)"
		 (softDelete)="onSoftDelete($event)"></app-grid-list>
		<div>
			<button mat-button
			 routerLink="/issues">
				SEE ALL ></button>
		</div>
	</ng-template>
</ng-container>

<ng-container *ngIf="loadingState !== 'complete';
	then skeletonFooter;
	else mainFooter">
</ng-container>

<!-- Templates -->

<ng-template #skeletonFooter>
	<div class="final-container container">
		<div class="skeleton-footer">
			<app-skeleton-button [width]="100"
			 class="footer-button">
			</app-skeleton-button>
			<app-skeleton-text-bar [isText]=true
			 [width]="205">
			</app-skeleton-text-bar>
		</div>
	</div>
</ng-template>

<ng-template #mainFooter>
	<div [@fadeIn]="isLoading"
	 *ngIf="!auth.isAuthenticated()"
	 class="final-container container text-center"
	 fxLayoutAlign="center center"
	 routerLink="/auth/signup">
		<div fxFlex.gt-sm="690px"
		 fxFlex.gt-md="800px">
			<button *ngIf="!org || !org.authType || org.authType===0"
			 mat-button
			 mat-raised-button
			 routerLink="/auth/signup"
			 color="warn"
			 class="mat-display-1">
				CREATE ACCOUNT</button>
			<button *ngIf="org && org.authType===1"
			 mat-button
			 mat-raised-button
			 routerLink="/auth/login"
			 color="warn"
			 class="mat-display-1">
				CREATE ACCOUNT</button>
			<span class="mat-body-2">&nbsp; to begin!</span>
			<br/>
			<span class="mat-caption"><em>Welcome to {{org.name}}!</em></span>
		</div>
	</div>
</ng-template>
